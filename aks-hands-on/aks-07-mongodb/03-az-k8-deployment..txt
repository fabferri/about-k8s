
> kubectl get all
NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE
service/kubernetes   ClusterIP   10.0.0.1     <none>        443/TCP   5m17s   

NOTE: it shows only the default


> kubectl apply -f mongo-secret.yaml
> kubectl get secret
secret/mongodb-secret created

> kubectl apply -f mongo.yaml
deployment.apps/mongodb-deployment created
service/mongodb-service created

> kubectl get all
NAME                                      READY   STATUS              RESTARTS   AGE
pod/mongodb-deployment-84d7c8b6dd-r9h2c   0/1     ContainerCreating   0          15s

NAME                      TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)     AGE
service/kubernetes        ClusterIP   10.0.0.1      <none>        443/TCP     12m
service/mongodb-service   ClusterIP   10.0.81.175   <none>        27017/TCP   15s

NAME                                 READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/mongodb-deployment   0/1     1            0           15s

NAME                                            DESIRED   CURRENT   READY   AGE
replicaset.apps/mongodb-deployment-84d7c8b6dd   1         1         0       15s


> kubectl get pod
NAME                                  READY   STATUS    RESTARTS   AGE
mongodb-deployment-84d7c8b6dd-r9h2c   1/1     Running   0          33s

> kubectl describe pod mongod
Name:             mongodb-deployment-84d7c8b6dd-r9h2c
Namespace:        default
Priority:         0
Service Account:  default
Node:             aks-nodepool1-78206344-vmss000001/10.224.0.4
Start Time:       Tue, 12 Dec 2023 19:28:25 +0000
Labels:           app=mongodb
                  pod-template-hash=84d7c8b6dd
Annotations:      <none>
Status:           Running
IP:               10.244.1.9
IPs:
  IP:           10.244.1.9
Controlled By:  ReplicaSet/mongodb-deployment-84d7c8b6dd
Containers:
  mongodb:
    Container ID:   containerd://d34c9fe2c98d58e470e1d908138f382299188f45fbb05fc2b5ae6015ee1fef62
    Image:          mongo
    Image ID:       docker.io/library/mongo@sha256:b679b96ec8a2692ebb6f7622b9097974c1f751b413b3db5a0629a244ae2c6950
    Port:           27017/TCP
    Host Port:      0/TCP
    State:          Running
      Started:      Tue, 12 Dec 2023 19:28:41 +0000
    Ready:          True
    Restart Count:  0
    Environment:
      MONGO_INITDB_ROOT_USERNAME:  <set to the key 'mongo-root-username' in secret 'mongodb-secret'>  Optional: false
      MONGO_INITDB_ROOT_PASSWORD:  <set to the key 'mongo-root-password' in secret 'mongodb-secret'>  Optional: false
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-fxmqc (ro)
Conditions:
  Type              Status
  Initialized       True
  Ready             True
  ContainersReady   True
  PodScheduled      True
Volumes:
  kube-api-access-fxmqc:
    Type:                    Projected (a volume that contains injected data from multiple sources)
    TokenExpirationSeconds:  3607
    ConfigMapName:           kube-root-ca.crt
    ConfigMapOptional:       <nil>
    DownwardAPI:             true
QoS Class:                   BestEffort
Node-Selectors:              <none>
Tolerations:                 node.kubernetes.io/not-ready:NoExecute op=Exists for 300s
                             node.kubernetes.io/unreachable:NoExecute op=Exists for 300s
Events:
  Type    Reason     Age   From               Message
  ----    ------     ----  ----               -------
  Normal  Scheduled  54s   default-scheduler  Successfully assigned default/mongodb-deployment-84d7c8b6dd-r9h2c to aks-nodepool1-78206344-vmss000001
  Normal  Pulling    54s   kubelet            Pulling image "mongo"
  Normal  Pulled     38s   kubelet            Successfully pulled image "mongo" in 15.933161757s (15.933185358s including waiting)
  Normal  Created    38s   kubelet            Created container mongodb
  Normal  Started    38s   kubelet            Started container mongodb



> kubectl get pod 
NAME                                  READY   STATUS    RESTARTS   AGE
mongodb-deployment-84d7c8b6dd-r9h2c   1/1     Running   0          3m26s

> kubectl get service
NAME              TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)     AGE
kubernetes        ClusterIP   10.0.0.1      <none>        443/TCP     19m
mongodb-service   ClusterIP   10.0.81.175   <none>        27017/TCP   7m17s

> kubectl describe service mongodb-service
Name:              mongodb-service
Namespace:         default
Labels:            <none>
Annotations:       <none>
Selector:          app=mongodb
Type:              ClusterIP
IP Family Policy:  SingleStack
IP Families:       IPv4
IP:                10.0.81.175
IPs:               10.0.81.175
Port:              <unset>  27017/TCP
TargetPort:        27017/TCP
Endpoints:         10.244.1.9:27017
Session Affinity:  None
Events:            <none>

> kubectl get pod -o wide
NAME                                  READY   STATUS    RESTARTS   AGE     IP           NODE                                NOMINATED NODE   READINESS GATES
mongodb-deployment-84d7c8b6dd-r9h2c   1/1     Running   0          5m10s   10.244.1.9   aks-nodepool1-78206344-vmss000001   <none>           <none>


> kubectl get all | select-string mongodb 
pod/mongodb-deployment-84d7c8b6dd-r9h2c   1/1     Running   0          15m
service/mongodb-service   ClusterIP   10.0.81.175   <none>        27017/TCP   15m
deployment.apps/mongodb-deployment   1/1     1            1           15m
replicaset.apps/mongodb-deployment-84d7c8b6dd   1         1         1       15m

# az aks list -o table
# kubectl get nodes
